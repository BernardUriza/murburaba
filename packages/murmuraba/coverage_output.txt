npm WARN ignoring workspace config at /workspaces/murburaba/packages/murmuraba/.npmrc 

> murmuraba@2.0.1 test:coverage
> vitest run --coverage


 RUN  v3.2.4 /workspaces/murburaba/packages/murmuraba
      Coverage enabled with v8

stdout | src/__tests__/integration/AudioDemo.browser-logs.test.tsx
üé≠ ========================================= üé≠
üöÄ INITIALIZING WEB AUDIO MOCKS 2025 EDITION üöÄ
üé≠ ========================================= üé≠

stdout | src/__tests__/integration/AudioDemo.browser-logs.test.tsx

üöÄ ========== VITEST SETUP STARTING ========== üöÄ


üé™ ====== SETTING UP ALL AUDIO MOCKS ====== üé™

üéÆ Setting up navigator.mediaDevices mock...
‚úÖ navigator.mediaDevices mock setup complete!

üéâ ====== ALL MOCKS READY TO ROCK! ====== üéâ


stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts
üé≠ ========================================= üé≠
üöÄ INITIALIZING WEB AUDIO MOCKS 2025 EDITION üöÄ
üé≠ ========================================= üé≠

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts

üöÄ ========== VITEST SETUP STARTING ========== üöÄ


üé™ ====== SETTING UP ALL AUDIO MOCKS ====== üé™

üéÆ Setting up navigator.mediaDevices mock...

üéâ ====== ALL MOCKS READY TO ROCK! ====== üéâ


stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Initialization branches > should handle suspended audio context
‚ùå [Murmuraba] [2025-07-24T14:42:31.155Z] [ERROR] WASM module loading timed out

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Initialization branches > should handle suspended audio context
‚ùå [Murmuraba] [2025-07-24T14:42:31.168Z] [ERROR] WASM module loading timed out

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Initialization branches > should handle WebAssembly not supported
‚ùå [Murmuraba] [2025-07-24T14:42:31.174Z] [ERROR] WebAssembly not supported

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Degraded mode > should initialize in degraded mode when configured
‚ùå [Murmuraba] [2025-07-24T14:42:31.177Z] [ERROR] WebAssembly not supported
‚ö†Ô∏è [Murmuraba] [2025-07-24T14:42:31.177Z] [WARN] Attempting degraded mode initialization...
‚ö†Ô∏è Invalid state transition: error -> degraded

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Degraded mode > should initialize in degraded mode when configured
‚ö†Ô∏è [Murmuraba] [2025-07-24T14:42:31.183Z] [WARN] Engine running in degraded mode - noise reduction disabled

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Degraded mode > should handle audio context failure in degraded mode
‚ùå [Murmuraba] [2025-07-24T14:42:31.190Z] [ERROR] WebAssembly not supported
‚ö†Ô∏è [Murmuraba] [2025-07-24T14:42:31.190Z] [WARN] Attempting degraded mode initialization...
‚ö†Ô∏è Invalid state transition: error -> degraded

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Degraded mode > should handle audio context failure in degraded mode
‚ùå [Murmuraba] [2025-07-24T14:42:31.190Z] [ERROR] Failed to create audio context even in degraded mode

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Destroy method > should force destroy from any state
‚ö†Ô∏è [Murmuraba] [2025-07-24T14:42:31.204Z] [WARN] Force destroying engine
‚ö†Ô∏è Invalid state transition: uninitialized -> destroying
‚ö†Ô∏è Invalid state transition: uninitialized -> destroyed

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > Destroy method > should handle errors during cleanup
‚ö†Ô∏è [Murmuraba] [2025-07-24T14:42:31.213Z] [WARN] Failed to close audio context: Error: Close failed
    at Object.<anonymous> [90m(/workspaces/murburaba/packages/murmuraba/[39msrc/__tests__/core/MurmubaraEngine.advanced.test.ts:329:43[90m)[39m
    at Object.mockCall (file:///workspaces/murburaba/node_modules/[4m@vitest[24m/spy/dist/index.js:96:15)
    at Object.spy [as close] (file:///workspaces/murburaba/node_modules/[4mtinyspy[24m/dist/index.js:47:103)
    at MurmubaraEngine.destroy [90m(/workspaces/murburaba/packages/murmuraba/[39msrc/core/MurmubaraEngine.ts:813:35[90m)[39m
    at [90m/workspaces/murburaba/packages/murmuraba/[39msrc/__tests__/core/MurmubaraEngine.advanced.test.ts:335:20
    at file:///workspaces/murburaba/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:155:11
    at file:///workspaces/murburaba/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:752:26
    at file:///workspaces/murburaba/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///workspaces/murburaba/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1863:10)

stdout | src/__tests__/core/MurmubaraEngine.advanced.test.ts > MurmubaraEngine Advanced Coverage > WASM loading > should handle WASM loading timeout
‚ùå [Murmuraba] [2025-07-24T14:42:36.228Z] [ERROR] WASM module loading timed out

 ‚ùØ src/__tests__/core/MurmubaraEngine.advanced.test.ts (24 tests | 7 failed) 10093ms
   ‚úì MurmubaraEngine Advanced Coverage > Initialization branches > should handle already initialized state 4ms
   √ó MurmubaraEngine Advanced Coverage > Initialization branches > should return existing promise if initialization in progress 7ms
     ‚Üí expected Promise{‚Ä¶} to be Promise{‚Ä¶} // Object.is equality

If it should pass with deep equality, replace "toBe" with "toStrictEqual"

Expected: Promise{‚Ä¶}
Received: serializes to the same string

   ‚úì MurmubaraEngine Advanced Coverage > Initialization branches > should handle suspended audio context  5014ms
   ‚úì MurmubaraEngine Advanced Coverage > Initialization branches > should handle AudioContext creation failure 4ms
   ‚úì MurmubaraEngine Advanced Coverage > Initialization branches > should handle WebAssembly not supported 2ms
   √ó MurmubaraEngine Advanced Coverage > Degraded mode > should initialize in degraded mode when configured 13ms
     ‚Üí expected 'error' to be 'degraded' // Object.is equality
   √ó MurmubaraEngine Advanced Coverage > Degraded mode > should handle audio context failure in degraded mode 2ms
     ‚Üí expected 'error' to be 'degraded' // Object.is equality
   ‚úì MurmubaraEngine Advanced Coverage > Error history > should maintain error history limit of 10 1ms
   ‚úì MurmubaraEngine Advanced Coverage > Error history > should handle non-Error objects 1ms
   ‚úì MurmubaraEngine Advanced Coverage > Auto cleanup > should not setup cleanup when disabled 1ms
   ‚úì MurmubaraEngine Advanced Coverage > Auto cleanup > should clear cleanup timer on processing start 3ms
   ‚úì MurmubaraEngine Advanced Coverage > Auto cleanup > should trigger cleanup after delay when no active streams 4ms
   ‚úì MurmubaraEngine Advanced Coverage > Metrics forwarding > should forward metrics updates 2ms
   √ó MurmubaraEngine Advanced Coverage > Destroy method > should force destroy from any state 6ms
     ‚Üí expected "spy" to be called at least once
   √ó MurmubaraEngine Advanced Coverage > Destroy method > should cleanup resources on destroy 2ms
     ‚Üí expected "spy" to be called at least once
   √ó MurmubaraEngine Advanced Coverage > Destroy method > should handle errors during cleanup 3ms
     ‚Üí Cleanup failed: Close failed
   ‚úì MurmubaraEngine Advanced Coverage > Configuration variations > should handle all log levels 4ms
   ‚úì MurmubaraEngine Advanced Coverage > Configuration variations > should handle custom log handler 1ms
   ‚úì MurmubaraEngine Advanced Coverage > Configuration variations > should handle all algorithms 3ms
   ‚úì MurmubaraEngine Advanced Coverage > Configuration variations > should handle worker configuration 1ms
   √ó MurmubaraEngine Advanced Coverage > getDiagnostics coverage > should return comprehensive diagnostics 2ms
     ‚Üí expected undefined to be 'uninitialized' // Object.is equality
   ‚úì MurmubaraEngine Advanced Coverage > getDiagnostics coverage > should handle missing performance.memory 1ms
   ‚úì MurmubaraEngine Advanced Coverage > WASM loading > should handle WASM loading timeout  5005ms
   ‚úì MurmubaraEngine Advanced Coverage > WASM loading > should handle missing createRNNWasmModule 4ms
stdout | src/__tests__/engines/RNNoiseEngine.test.ts
üé≠ ========================================= üé≠
üöÄ INITIALIZING WEB AUDIO MOCKS 2025 EDITION üöÄ
üé≠ ========================================= üé≠

stdout | src/__tests__/engines/RNNoiseEngine.test.ts

üöÄ ========== VITEST SETUP STARTING ========== üöÄ


üé™ ====== SETTING UP ALL AUDIO MOCKS ====== üé™

üéÆ Setting up navigator.mediaDevices mock...

üéâ ====== ALL MOCKS READY TO ROCK! ====== üéâ


stdout | src/__tests__/engines/RNNoiseEngine.test.ts > RNNoiseEngine > edge cases > should handle concurrent initialization attempts
‚ùå [RNNoiseEngine] Failed to load from import: rnnoiseModule.default is not a function
‚ùå [RNNoiseEngine] Failed to load from import: rnnoiseModule.default is not a function

 ‚ùØ src/__tests__/engines/RNNoiseEngine.test.ts (25 tests | 7 failed) 457ms
   ‚úì RNNoiseEngine > constructor > should create instance with default config 3ms
   ‚úì RNNoiseEngine > constructor > should accept custom config 2ms
   ‚úì RNNoiseEngine > initialize > should not reinitialize if already initialized 3ms
   ‚úì RNNoiseEngine > initialize > should check WebAssembly support 5ms
   ‚úì RNNoiseEngine > initialize > should initialize with dynamic import (Option 1) 3ms
   √ó RNNoiseEngine > initialize > should fallback to embedded loader when dynamic import fails (Option 2) 7ms
     ‚Üí Cannot find module '/workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/dist/rnnoise' imported from /workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/index.js
   √ó RNNoiseEngine > initialize > should fallback to script tag when both imports fail (Option 3) 3ms
     ‚Üí Cannot find module '/workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/dist/rnnoise' imported from /workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/index.js
   √ó RNNoiseEngine > initialize > should handle script loading with custom paths 2ms
     ‚Üí Cannot find module '/workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/dist/rnnoise' imported from /workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/index.js
   √ó RNNoiseEngine > initialize > should handle script loading errors 3ms
     ‚Üí Cannot find module '/workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/dist/rnnoise' imported from /workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/index.js
   √ó RNNoiseEngine > initialize > should handle missing createRNNWasmModule after script load 2ms
     ‚Üí Cannot find module '/workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/dist/rnnoise' imported from /workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/index.js
   √ó RNNoiseEngine > initialize > should handle WASM loading errors with specific message 2ms
     ‚Üí Cannot find module '/workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/dist/rnnoise' imported from /workspaces/murburaba/node_modules/@jitsi/rnnoise-wasm/index.js
   ‚úì RNNoiseEngine > initialize > should handle RNNoise state creation failure 1ms
   ‚úì RNNoiseEngine > initialize > should perform warmup with silent frames 1ms
   ‚úì RNNoiseEngine > process > should throw if not initialized 3ms
   ‚úì RNNoiseEngine > process > should validate input buffer size 2ms
   ‚úì RNNoiseEngine > process > should process audio frame correctly 11ms
   ‚úì RNNoiseEngine > process > should store VAD value from processing 2ms
   ‚úì RNNoiseEngine > process > should handle zero VAD value 2ms
   ‚úì RNNoiseEngine > process > should handle undefined VAD value 2ms
   ‚úì RNNoiseEngine > cleanup > should clean up resources when initialized 2ms
   ‚úì RNNoiseEngine > cleanup > should handle cleanup when not initialized 1ms
   ‚úì RNNoiseEngine > cleanup > should handle cleanup when partially initialized 3ms
   ‚úì RNNoiseEngine > edge cases > should handle multiple initialization attempts after cleanup 1ms
   ‚úì RNNoiseEngine > edge cases > should handle process with special float values 1ms
   √ó RNNoiseEngine > edge cases > should handle concurrent initialization attempts 390ms
     ‚Üí expected "spy" to be called 1 times, but got 2 times
stdout | src/components/__tests__/AdvancedMetricsPanel.test.tsx
üé≠ ========================================= üé≠
üöÄ INITIALIZING WEB AUDIO MOCKS 2025 EDITION üöÄ
üé≠ ========================================= üé≠

stdout | src/components/__tests__/AdvancedMetricsPanel.test.tsx

üöÄ ========== VITEST SETUP STARTING ========== üöÄ


üé™ ====== SETTING UP ALL AUDIO MOCKS ====== üé™

üéÆ Setting up navigator.mediaDevices mock...

üéâ ====== ALL MOCKS READY TO ROCK! ====== üéâ


 ‚ùØ src/components/__tests__/AdvancedMetricsPanel.test.tsx (31 tests | 31 failed) 63ms
   √ó AdvancedMetricsPanel TDD Tests > Visibility and Basic Rendering > should not render when isVisible is false 7ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Visibility and Basic Rendering > should not render when diagnostics is null 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Visibility and Basic Rendering > should render when both isVisible is true and diagnostics exists 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Visibility and Basic Rendering > should render with proper structure 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Header and Close Functionality > should display correct header title 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Header and Close Functionality > should render close button 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Header and Close Functionality > should call onClose when close button is clicked 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Diagnostics Data Display > should display engine version 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Diagnostics Data Display > should display WASM status - loaded 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Diagnostics Data Display > should display WASM status - not loaded 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Diagnostics Data Display > should display active processors count 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Diagnostics Data Display > should display memory usage in MB 3ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Diagnostics Data Display > should display processing time with decimal precision 3ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Diagnostics Data Display > should display engine state 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Browser Information > should display browser name when available 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Browser Information > should display Unknown when browser name is not available 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Browser Information > should display Unknown when browserInfo is null 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Browser Information > should display audio APIs supported status - supported 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Browser Information > should display audio APIs supported status - limited 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Performance Indicators > should show Good performance for low memory usage 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Performance Indicators > should show Moderate performance for medium memory usage 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Performance Indicators > should show High performance warning for high memory usage 7ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Performance Indicators > should handle edge case at 50MB threshold 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Performance Indicators > should handle edge case at 100MB threshold 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Uptime Display > should display uptime status as Active 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Edge Cases and Error Handling > should handle missing browserInfo gracefully 2ms
     ‚Üí expected [Function] to not throw an error but 'Error: createRoot(...): Target contai‚Ä¶' was thrown
   √ó AdvancedMetricsPanel TDD Tests > Edge Cases and Error Handling > should handle zero memory usage 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Edge Cases and Error Handling > should handle negative memory usage 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Edge Cases and Error Handling > should handle zero processing time 1ms
     ‚Üí createRoot(...): Target container is not a DOM element.
   √ó AdvancedMetricsPanel TDD Tests > Edge Cases and Error Handling > should handle very large numbers 2ms
     ‚Üí expected [Function] to not throw an error but 'Error: createRoot(...): Target contai‚Ä¶' was thrown
   √ó AdvancedMetricsPanel TDD Tests > Component Unmounting > should unmount cleanly without errors 2ms
     ‚Üí createRoot(...): Target container is not a DOM element.
stdout | src/__tests__/integration/noiseReduction.test.ts
üé≠ ========================================= üé≠
üöÄ INITIALIZING WEB AUDIO MOCKS 2025 EDITION üöÄ
üé≠ ========================================= üé≠

stdout | src/__tests__/integration/noiseReduction.test.ts

üöÄ ========== VITEST SETUP STARTING ========== üöÄ


üé™ ====== SETTING UP ALL AUDIO MOCKS ====== üé™

üéÆ Setting up navigator.mediaDevices mock...

üéâ ====== ALL MOCKS READY TO ROCK! ====== üéâ


stdout | src/__tests__/integration/noiseReduction.test.ts > Noise Reduction Integration Tests > White Noise Reduction > should reduce white noise from sine wave
‚ùå [RNNoiseEngine] Failed to load from import: rnnoiseModule.default is not a function

stdout | src/__tests__/integration/noiseReduction.test.ts > Noise Reduction Integration Tests > White Noise Reduction > should reduce white noise from sine wave
‚ùå [RNNoise] Initialization failed: TypeError: module.default is not a function
    at loadWasmModule [90m(/workspaces/murburaba/packages/murmuraba/[39msrc/engines/rnnoise-universal-loader.ts:11:23[90m)[39m
    at initializeRNNoise [90m(/workspaces/murburaba/packages/murmuraba/[39msrc/engines/rnnoise-universal-loader.ts:19:20[90m)[39m
    at RNNoiseEngine.initialize [90m(/workspaces/murburaba/packages/murmuraba/[39msrc/engines/RNNoiseEngine.ts:53:33[90m)[39m
    at [90m/workspaces/murburaba/packages/murmuraba/[39msrc/__tests__/integration/noiseReduction.test.ts:62:5

stdout | src/__tests__/integration/noiseReduction.test.ts > Noise Reduction Integration Tests > White Noise Reduction > should reduce white noise from sine wave
‚ùå [RNNoiseEngine] Failed to load embedded: module.default is not a function

